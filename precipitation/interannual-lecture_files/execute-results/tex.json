{
  "hash": "bb61743f9184ba72c506d9b04aed1d97",
  "result": {
    "markdown": "---\ntitle: Interannual variability of precipitation\nexecute:\n  freeze: auto\n---\n\n![](/archive/figures/monthly_tel_aviv_1940-1999.png)\n\n## hydrological year\n\nA time period of 12 months for which precipitation totals are measured. The hydrological year is designated by the calendar year in which it **ends**.  \nLet's define the hydrological year for Tel Aviv from 1 October to 30 September.\n\nהאם אקלים הגשם שלנו משתנה\n> youtube: https://youtu.be/v0uNpj03Rk4\n\n![](/archive/figures/annual_tel_aviv_with_mean.png)\n\n![](/archive/figures/histogram_tel_aviv_with_mean_and_std.png)\n\n## coefficient of variation\n\n$\\langle{P}\\rangle=$ average precipitation  \n$\\sigma=$ standard deviation\n\n$$CV = \\frac{\\sigma}{\\langle{P}\\rangle}$$\n\nAssuming that the inter-annual distribution is a gaussian: 67% of the time, rainfall will vary +/- 30% from its long term average in Tel Aviv.\n\nPrecipitation averages are [usually calculated for time intervals of 30 years](https://www.ncdc.noaa.gov/news/defining-climate-normals-new-ways).\n\n![](/archive/figures/mean_tel_aviv_2_windows.png)\n\n![](/archive/figures/mean_tel_aviv_4_windows.png)\n\n::: {.cell execution_count=1}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show/hide the code\"}\nimport altair as alt\nimport pandas as pd\n\ndf = pd.read_csv(\"TEL_AVIV_READING_monthly.csv\", sep=\",\")\n# make 'DATE' the dataframe index\ndf['DATE'] = pd.to_datetime(df['DATE'])\ndf = df.set_index('DATE')\n\ndf_year_all = df['PRCP'].resample('A-SEP').sum().to_frame()  # annual frequency, anchored end of September\ndf_year_all.columns = ['rain (mm)'] # rename 'PRCP' column to 'rain (mm)'\ndf_year = df_year_all.iloc[:-1]  # exclude last row\n\n# Altair only recognizes column data; it ignores index values.\n# You can plot the index data by first resetting the index\n# I know that I've just made 'DATE' the index, but I want to have this here nonetheless so I can refer to this in the future\nsource = df_year.reset_index()\nbrush = alt.selection(type='interval', encodings=['x'])\n\n# T: temporal, a time or date value\n# Q: quantitative, a continuous real-valued quantity\n# https://altair-viz.github.io/user_guide/encoding.html#encoding-data-types\nbars = alt.Chart().mark_bar().encode(\n    x=alt.X('DATE:T', axis=alt.Axis(title='date')),\n    y=alt.Y('rain (mm):Q',  axis=alt.Axis(title='annual precipitation (mm) and average')),\n    opacity=alt.condition(brush, alt.OpacityValue(1), alt.OpacityValue(0.2)),\n).add_selection(\n    brush\n).properties(\n    title='Select year range and drag for rolling average of annual precipitation in Tel Aviv'\n).properties(\n    width=600,\n    height=400\n)\n\nline = alt.Chart().mark_rule(color='orange').encode(\n    y='mean(rain (mm)):Q',\n    size=alt.SizeValue(3)\n).transform_filter(\n    brush\n)\n\nalt.layer(bars, line, data=source)\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\nalt.LayerChart(...)\n```\n:::\n:::\n\n\n",
    "supporting": [
      "interannual-lecture_files/figure-pdf"
    ],
    "filters": []
  }
}